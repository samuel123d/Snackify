<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SNACKIFY</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

  <style>
    :root {
      --accent: #111827;
    }
    body, html {
      height: 100%;
      margin: 0;
      display: flex;
      flex-direction: column;
    }
    main {
      flex: 1 0 auto;
      padding-bottom: 100px; /* espaço para o footer fixo */
    }
    .card-icon {
      font-size: 4rem;
      text-align: center;
      color: #ff9900;
      padding-top: 20px;
      padding-bottom: 10px;
    }
    footer {
      flex-shrink: 0;
      background: #fff;
      border-top: 1px solid #e6e6ee;
      padding: 18px 0;
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 1000;
    }
  </style>
</head>
<body>

  <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#">SNACKIFY</a>
      <button class="btn btn-outline-secondary d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas">
        Carrinho <span id="cartCountBadgeSmall" class="badge bg-danger ms-2">0</span>
      </button>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item d-none d-lg-block">
            <button class="btn btn-outline-primary" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas">
              Ver carrinho <span id="cartCountBadge" class="badge bg-danger ms-2">0</span>
            </button>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <header class="py-5 text-center">
    <div class="container">
      <h1 class="display-6">Peça seus snacks e bebidas pelo WhatsApp</h1>
      <p class="text-muted mt-2">Cheetos, Ruffles, Doritos, Fandangos, Kró, Coca-Cola, Fanta, Guaraná, Sprite e muito mais.</p>
    </div>
  </header>

  <main class="container mb-5">
    <section class="mb-5">
      <h2 class="h4 mb-3">Salgadinhos</h2>
      <div id="salgadinhosGrid" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3"></div>
    </section>

    <section>
      <h2 class="h4 mb-3">Bebidas</h2>
      <div id="bebidasGrid" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-3"></div>
    </section>
  </main>

  <!-- Carrinho -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title">Carrinho</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body d-flex flex-column">
      <div id="cartItems" class="list-group mb-3"></div>
      <div class="mt-auto">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <strong>Total</strong>
          <strong id="cartTotal">R$ 0,00</strong>
        </div>
        <div class="d-grid gap-2">
          <button id="clearCartBtn" class="btn btn-outline-secondary">Limpar carrinho</button>
          <button id="checkoutBtn" class="btn btn-success">Finalizar compra</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Rodapé -->
  <footer>
    <div class="container d-flex justify-content-between align-items-center">
      <small class="text-muted">SNACKIFY • Peça direto pelo WhatsApp</small>
      <a id="quickWhatsBtn" class="btn btn-success btn-sm" href="#" target="_blank">WhatsApp</a>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const WHATSAPP_NUMBER = "5584999568739";

    const produtos = {
      salgadinhos: [
        { nome: "Cheetos", icone: "bi-bag-fill", preco: 6.50 },
        { nome: "Ruffles", icone: "bi-bag-fill", preco: 7.00 },
        { nome: "Doritos", icone: "bi-bag-fill", preco: 8.00 },
        { nome: "Fandangos", icone: "bi-bag-fill", preco: 5.50 },
        { nome: "Kró", icone: "bi-bag-fill", preco: 4.00 }
      ],
      bebidas: [
        { nome: "Coca-Cola", icone: "bi-cup-straw", preco: 5.00 },
        { nome: "Fanta Laranja", icone: "bi-cup-straw", preco: 5.00 },
        { nome: "Fanta Uva", icone: "bi-cup-straw", preco: 5.00 },
        { nome: "Guaraná Antarctica", icone: "bi-cup-straw", preco: 5.00 },
        { nome: "Sprite", icone: "bi-cup-straw", preco: 5.00 }
      ]
    };

    const tamanhos = ["P", "M", "G"];
    const precoAjuste = { "P": 0, "M": 1, "G": 2 }; // diferença de 1 real por tamanho

    let cart = [];

    function formatMoney(v){return v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'})}
    function updateCartBadges(){
      const c=cart.reduce((s,it)=>s+it.quantidade,0);
      document.getElementById('cartCountBadge').textContent=c;
      document.getElementById('cartCountBadgeSmall').textContent=c;
    }
    function calculateTotal(){
      return cart.reduce((s,it)=>s+(it.preco*it.quantidade),0);
    }

    function criarCard(prod, tam, container){
      const col=document.createElement('div');
      col.className='col';
      const precoFinal = prod.preco + precoAjuste[tam];
      col.innerHTML=`
        <div class="card h-100 shadow-sm">
          <div class="card-icon"><i class="bi ${prod.icone}"></i></div>
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">${prod.nome}</h5>
            <div class="text-muted mb-2">${tam}</div>
            <div class="mt-auto d-flex justify-content-between align-items-center">
              <span>${formatMoney(precoFinal)}</span>
              <button class="btn btn-primary btn-sm">Adicionar</button>
            </div>
          </div>
        </div>`;
      col.querySelector('button').addEventListener('click',()=>{
        addToCart({
          id:prod.nome+'_'+tam,
          nome:prod.nome,
          tamanho:tam,
          preco:precoFinal,
          quantidade:1
        });
      });
      container.appendChild(col);
    }

    function gerarCards(lista, containerId){
      const container=document.getElementById(containerId);
      container.innerHTML='';
      lista.forEach(p=>tamanhos.forEach(t=>criarCard(p,t,container)));
    }

    function addToCart(item){
      const f=cart.find(i=>i.id===item.id);
      if(f){f.quantidade+=item.quantidade}else{cart.push({...item})}
      renderCart();
      // abrir o carrinho sem bloquear fundo
      const offcanvas = bootstrap.Offcanvas.getOrCreateInstance(document.getElementById('cartOffcanvas'), {
        backdrop: false,
        scroll: true
      });
      offcanvas.show();
    }

    function removeFromCart(id){
      cart=cart.filter(i=>i.id!==id);
      renderCart();
    }
    window.removeFromCart=removeFromCart;

    function changeQuantity(id,delta){
      const it=cart.find(i=>i.id===id);
      if(!it)return;
      it.quantidade=Math.max(1,it.quantidade+delta);
      renderCart();
    }
    window.changeQuantity=changeQuantity;

    function renderCart(){
      const cont=document.getElementById('cartItems');
      cont.innerHTML='';
      if(cart.length===0){
        cont.innerHTML='<div class="text-muted">Carrinho vazio.</div>';
      }else{
        cart.forEach(it=>{
          const li=document.createElement('div');
          li.className='list-group-item d-flex justify-content-between align-items-center';
          li.innerHTML=`
            <div>
              <strong>${it.nome}</strong> <small class="text-muted">(${it.tamanho})</small><br>
              <small class="text-muted">${formatMoney(it.preco)} cada</small>
            </div>
            <div class="d-flex align-items-center gap-2">
              <div class="input-group input-group-sm" style="width:110px;">
                <button class="btn btn-outline-secondary" onclick="changeQuantity('${it.id}',-1)">−</button>
                <input class="form-control text-center" value="${it.quantidade}" disabled>
                <button class="btn btn-outline-secondary" onclick="changeQuantity('${it.id}',1)">+</button>
              </div>
              <div class="text-end">
                <div>${formatMoney(it.preco*it.quantidade)}</div>
                <button class="btn btn-link text-danger btn-sm p-0" onclick="removeFromCart('${it.id}')">Remover</button>
              </div>
            </div>`;
          cont.appendChild(li);
        });
      }
      document.getElementById('cartTotal').textContent=formatMoney(calculateTotal());
      updateCartBadges();
      updateQuickWhatsLink();
    }

    document.getElementById('clearCartBtn').addEventListener('click',()=>{
      if(cart.length===0)return;
      if(!confirm('Deseja limpar o carrinho?'))return;
      cart=[];
      renderCart();
    });

    document.getElementById('checkoutBtn').addEventListener('click',()=>{
      if(cart.length===0){alert('Carrinho vazio.');return;}
      let msg=`Olá! Quero fazer um pedido:%0A`;
      cart.forEach((it,idx)=>{
        msg+=`${idx+1}) ${it.nome} - ${it.tamanho} x${it.quantidade} = ${formatMoney(it.preco*it.quantidade)}%0A`;
      });
      msg+=`%0ATotal: ${formatMoney(calculateTotal())}`;
      window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`, '_blank');
    });

    function updateQuickWhatsLink(){
      const link=document.getElementById('quickWhatsBtn');
      if(cart.length===0){
        link.href=`https://wa.me/${WHATSAPP_NUMBER}`;
      } else {
        let msg=`Olá! Pedido: `;
        msg+=cart.map(it=>`${it.nome}(${it.tamanho}) x${it.quantidade}`).join(', ');
        msg+=` - Total: ${formatMoney(calculateTotal())}`;
        link.href=`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
      }
    }

    gerarCards(produtos.salgadinhos,'salgadinhosGrid');
    gerarCards(produtos.bebidas,'bebidasGrid');
    renderCart();
  </script>
</body>
</html>
